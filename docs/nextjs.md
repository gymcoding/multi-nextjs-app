# Next.js 프로젝트 구조 및 구성 가이드

> **문서 버전**: 16.0.10
> **최종 업데이트**: 2025-10-23

---

## 폴더 및 파일 규칙

### 최상위 폴더

애플리케이션 코드와 정적 자산을 구성하는 최상위 폴더입니다.

| 폴더       | 설명                          |
| ---------- | ----------------------------- |
| `app`      | App Router (권장)             |
| `pages`    | Pages Router (레거시)         |
| `public`   | 정적 자산 제공 폴더           |
| `src`      | 선택적 애플리케이션 소스 폴더 |

---

### 최상위 파일

애플리케이션 설정, 의존성 관리, 환경 변수 정의 등에 사용되는 파일입니다.

| 파일                  | 설명                                                 |
| --------------------- | ---------------------------------------------------- |
| `next.config.js`      | Next.js 설정 파일                                    |
| `package.json`        | 프로젝트 의존성 및 스크립트                          |
| `instrumentation.ts`  | OpenTelemetry 및 계측 파일                           |
| `proxy.ts`            | Next.js 요청 프록시                                  |
| `.env`                | 환경 변수 (버전 관리에서 제외해야 함)                |
| `.env.local`          | 로컬 환경 변수 (버전 관리에서 제외해야 함)           |
| `.env.production`     | 프로덕션 환경 변수 (버전 관리에서 제외해야 함)       |
| `.env.development`    | 개발 환경 변수 (버전 관리에서 제외해야 함)           |
| `eslint.config.mjs`   | ESLint 설정 파일                                     |
| `.gitignore`          | Git에서 무시할 파일 및 폴더                          |
| `next-env.d.ts`       | Next.js TypeScript 선언 파일 (버전 관리에서 제외)    |
| `tsconfig.json`       | TypeScript 설정 파일                                 |
| `jsconfig.json`       | JavaScript 설정 파일                                 |

---

## 라우팅 파일

라우트를 노출하려면 `page`를, 공유 UI(헤더, 네비게이션, 푸터 등)에는 `layout`을, 스켈레톤에는 `loading`을, 에러 바운더리에는 `error`를, API에는 `route`를 추가합니다.

| 파일명         | 확장자              | 용도                       |
| -------------- | ------------------- | -------------------------- |
| `layout`       | `.js` `.jsx` `.tsx` | 레이아웃                   |
| `page`         | `.js` `.jsx` `.tsx` | 페이지                     |
| `loading`      | `.js` `.jsx` `.tsx` | 로딩 UI                    |
| `not-found`    | `.js` `.jsx` `.tsx` | 404 페이지 UI              |
| `error`        | `.js` `.jsx` `.tsx` | 에러 UI                    |
| `global-error` | `.js` `.jsx` `.tsx` | 전역 에러 UI               |
| `route`        | `.js` `.ts`         | API 엔드포인트             |
| `template`     | `.js` `.jsx` `.tsx` | 재렌더링 레이아웃          |
| `default`      | `.js` `.jsx` `.tsx` | 병렬 라우트 폴백 페이지    |

---

## 중첩 라우트

폴더는 URL 세그먼트를 정의합니다. 폴더를 중첩하면 세그먼트가 중첩됩니다. 모든 레벨의 레이아웃은 하위 세그먼트를 감쌉니다. `page` 또는 `route` 파일이 존재하면 라우트가 공개됩니다.

| 경로                        | URL 패턴        | 설명                          |
| --------------------------- | --------------- | ----------------------------- |
| `app/layout.tsx`            | —               | 루트 레이아웃 (모든 라우트)   |
| `app/blog/layout.tsx`       | —               | `/blog` 및 하위 항목을 감싸기 |
| `app/page.tsx`              | `/`             | 공개 라우트                   |
| `app/blog/page.tsx`         | `/blog`         | 공개 라우트                   |
| `app/blog/authors/page.tsx` | `/blog/authors` | 공개 라우트                   |

---

## 동적 라우트

대괄호를 사용하여 세그먼트를 매개변수화합니다. `params` prop을 통해 값에 접근할 수 있습니다.

| 구문                  | 경로 예시                         | 설명                                |
| --------------------- | --------------------------------- | ----------------------------------- |
| `[slug]`              | `app/blog/[slug]/page.tsx`        | 단일 매개변수 (`/blog/my-post`)     |
| `[...slug]`           | `app/shop/[...slug]/page.tsx`     | Catch-all (`/shop/a`, `/shop/a/b`)  |
| `[[...slug]]`         | `app/docs/[[...slug]]/page.tsx`   | 선택적 Catch-all (`/docs` 또는 `/docs/a/b`) |

---

## 라우트 그룹과 프라이빗 폴더

### 라우트 그룹 `(folderName)`

URL을 변경하지 않고 코드를 구성합니다. 괄호 안의 폴더는 URL에서 생략됩니다.

**용도:**
- 사이트 섹션, 목적, 팀별로 라우트 구성 (예: 마케팅 페이지, 관리자 페이지)
- 동일한 라우트 세그먼트 레벨에서 중첩 레이아웃 활성화
- 여러 루트 레이아웃 생성

| 경로                       | URL 패턴 | 설명                    |
| -------------------------- | -------- | ----------------------- |
| `app/(marketing)/page.tsx` | `/`      | 그룹이 URL에서 생략됨   |
| `app/(shop)/cart/page.tsx` | `/cart`  | `(shop)` 내에서 레이아웃 공유 |

### 프라이빗 폴더 `_folderName`

라우팅 시스템에서 제외되는 폴더입니다. 밑줄로 시작하는 폴더와 모든 하위 폴더는 라우팅에서 제외됩니다.

**용도:**
- UI 로직과 라우팅 로직 분리
- 프로젝트 전체에서 내부 파일을 일관되게 구성
- 코드 편집기에서 파일 정렬 및 그룹화
- 향후 Next.js 파일 규칙과의 충돌 방지

| 경로                            | 설명                             |
| ------------------------------- | -------------------------------- |
| `app/blog/_components/Post.tsx` | 라우팅 불가 - UI 유틸리티 보관   |
| `app/blog/_lib/data.ts`         | 라우팅 불가 - 유틸리티 보관      |

---

## 병렬 및 인터셉트 라우트

슬롯 기반 레이아웃이나 모달 라우팅 같은 특정 UI 패턴에 적합합니다.

### 병렬 라우트 `@slot`

부모 레이아웃에서 렌더링되는 명명된 슬롯입니다.

**사용 사례:** 사이드바 + 메인 콘텐츠

### 인터셉트 라우트

URL을 변경하지 않고 현재 레이아웃 내에서 다른 라우트를 렌더링합니다 (예: 목록 위에 모달로 상세 보기 표시).

| 패턴             | 의미                 | 일반적인 사용 사례              |
| ---------------- | -------------------- | ------------------------------- |
| `(.)folder`      | 같은 레벨 인터셉트   | 형제 라우트를 모달로 미리보기   |
| `(..)folder`     | 부모 인터셉트        | 부모의 자식을 오버레이로 열기   |
| `(..)(..)folder` | 두 레벨 인터셉트     | 깊게 중첩된 오버레이            |
| `(...)folder`    | 루트에서 인터셉트    | 현재 뷰에서 임의의 라우트 표시  |

---

## 메타데이터 파일 규칙

### 앱 아이콘

| 파일명         | 확장자                            | 설명               |
| -------------- | --------------------------------- | ------------------ |
| `favicon`      | `.ico`                            | 파비콘 파일        |
| `icon`         | `.ico` `.jpg` `.jpeg` `.png` `.svg` | 앱 아이콘 파일     |
| `icon`         | `.js` `.ts` `.tsx`                | 생성된 앱 아이콘   |
| `apple-icon`   | `.jpg` `.jpeg` `.png`             | Apple 앱 아이콘    |
| `apple-icon`   | `.js` `.ts` `.tsx`                | 생성된 Apple 아이콘 |

### Open Graph 및 Twitter 이미지

| 파일명            | 확장자                       | 설명                    |
| ----------------- | ---------------------------- | ----------------------- |
| `opengraph-image` | `.jpg` `.jpeg` `.png` `.gif` | Open Graph 이미지 파일  |
| `opengraph-image` | `.js` `.ts` `.tsx`           | 생성된 Open Graph 이미지 |
| `twitter-image`   | `.jpg` `.jpeg` `.png` `.gif` | Twitter 이미지 파일     |
| `twitter-image`   | `.js` `.ts` `.tsx`           | 생성된 Twitter 이미지   |

### SEO

| 파일명    | 확장자       | 설명             |
| --------- | ------------ | ---------------- |
| `sitemap` | `.xml`       | 사이트맵 파일    |
| `sitemap` | `.js` `.ts`  | 생성된 사이트맵  |
| `robots`  | `.txt`       | Robots 파일      |
| `robots`  | `.js` `.ts`  | 생성된 Robots    |

---

## 컴포넌트 계층 구조

특수 파일에 정의된 컴포넌트는 특정 계층 구조로 렌더링됩니다:

```
layout.js
└── template.js
    └── error.js (React 에러 바운더리)
        └── loading.js (React Suspense 바운더리)
            └── not-found.js (React 에러 바운더리)
                └── page.js 또는 중첩 layout.js
```

중첩 라우트에서 컴포넌트는 재귀적으로 렌더링되며, 라우트 세그먼트의 컴포넌트는 부모 세그먼트의 컴포넌트 **내부에** 중첩됩니다.

---

## 코로케이션 (Colocation)

`app` 디렉토리에서 중첩된 폴더는 라우트 구조를 정의합니다. 그러나 `page.js` 또는 `route.js` 파일이 라우트 세그먼트에 추가되기 전까지 라우트는 **공개적으로 접근할 수 없습니다**.

이는 프로젝트 파일이 실수로 라우팅되지 않고 `app` 디렉토리 내의 라우트 세그먼트에 **안전하게 코로케이션**될 수 있음을 의미합니다.

> **참고:** `app`에 프로젝트 파일을 코로케이션할 수 있지만 반드시 그럴 필요는 없습니다. 원한다면 `app` 디렉토리 외부에 보관할 수 있습니다.

---

## 프로젝트 구성 전략

Next.js는 프로젝트 파일 구성 방법에 대해 **의견을 강제하지 않습니다**. 팀에 맞는 전략을 선택하고 프로젝트 전체에서 일관성을 유지하세요.

### 전략 1: `app` 외부에 프로젝트 파일 저장

모든 애플리케이션 코드를 프로젝트 **루트**의 공유 폴더에 저장하고, `app` 디렉토리는 순수하게 라우팅 목적으로만 사용합니다.

```
project-root/
├── components/      # 공유 컴포넌트
├── lib/            # 유틸리티 함수
├── app/            # 라우팅만 담당
│   ├── page.tsx
│   └── layout.tsx
└── package.json
```

### 전략 2: `app` 내부 최상위 폴더에 프로젝트 파일 저장

모든 애플리케이션 코드를 **`app` 디렉토리 루트**의 공유 폴더에 저장합니다.

```
app/
├── components/     # 공유 컴포넌트
├── lib/           # 유틸리티 함수
├── page.tsx
└── layout.tsx
```

### 전략 3: 기능 또는 라우트별로 프로젝트 파일 분할

전역적으로 공유되는 애플리케이션 코드는 루트 `app` 디렉토리에 저장하고, 더 구체적인 애플리케이션 코드는 이를 사용하는 라우트 세그먼트로 **분할**합니다.

```
app/
├── components/           # 전역 공유 컴포넌트
├── lib/                 # 전역 유틸리티
├── dashboard/
│   ├── _components/     # 대시보드 전용 컴포넌트
│   ├── _lib/           # 대시보드 전용 유틸리티
│   └── page.tsx
└── page.tsx
```

---

## 실용적인 예제

### URL 경로에 영향 없이 라우트 구성하기

관련 라우트를 함께 유지하는 그룹을 생성합니다. 괄호 안의 폴더는 URL에서 생략됩니다.

```
app/
├── (marketing)/
│   ├── about/page.tsx     # /about
│   └── contact/page.tsx   # /contact
├── (shop)/
│   ├── cart/page.tsx      # /cart
│   └── products/page.tsx  # /products
└── page.tsx               # /
```

### 특정 세그먼트에 레이아웃 적용하기

동일한 레이아웃을 공유하는 라우트를 새 라우트 그룹으로 이동합니다.

```
app/
├── (shop)/
│   ├── layout.tsx         # cart, account에 적용
│   ├── cart/page.tsx
│   └── account/page.tsx
├── checkout/page.tsx      # 레이아웃 공유 안 함
└── layout.tsx
```

### 특정 라우트에 로딩 스켈레톤 적용하기

특정 라우트에 `loading.js`를 통해 로딩 스켈레톤을 적용하려면 새 라우트 그룹을 생성하고 `loading.tsx`를 해당 그룹 내에 이동합니다.

```
app/
└── dashboard/
    ├── (overview)/
    │   ├── loading.tsx    # overview에만 적용
    │   └── page.tsx
    └── settings/page.tsx  # loading 적용 안 됨
```

### 여러 루트 레이아웃 생성하기

여러 루트 레이아웃을 생성하려면 최상위 `layout.js` 파일을 제거하고 각 라우트 그룹 내에 `layout.js` 파일을 추가합니다. 완전히 다른 UI나 경험을 가진 섹션으로 애플리케이션을 분할할 때 유용합니다.

```
app/
├── (marketing)/
│   ├── layout.tsx         # 마케팅 전용 루트 레이아웃
│   └── page.tsx
└── (shop)/
    ├── layout.tsx         # 쇼핑 전용 루트 레이아웃
    └── page.tsx
```

> **중요:** 각 루트 레이아웃에는 `<html>`과 `<body>` 태그를 추가해야 합니다.

---

## 빠른 참조

| 개념             | 구문/패턴            | 용도                                    |
| ---------------- | -------------------- | --------------------------------------- |
| 동적 세그먼트    | `[slug]`             | 단일 동적 매개변수                      |
| Catch-all        | `[...slug]`          | 모든 하위 경로 캡처                     |
| 선택적 Catch-all | `[[...slug]]`        | 루트 포함 모든 경로 캡처                |
| 라우트 그룹      | `(folderName)`       | URL에 영향 없이 구성                    |
| 프라이빗 폴더    | `_folderName`        | 라우팅에서 제외                         |
| 병렬 라우트      | `@slot`              | 명명된 슬롯                             |
| 인터셉트 라우트  | `(.)`, `(..)`, `(...)` | 다른 라우트 인터셉트                  |
